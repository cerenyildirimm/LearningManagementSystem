@model lms.Models.CourseEnrollement

@{
    var selectedStep = 1;
    void setStep (int step)
    {
        selectedStep = step;
    }
}

<div class="untree_co-hero overlay" style="background-image: url(@Model.course.imageURL);background-size: auto 300px;">
    <div class="container">
        <div class="row align-items-center justify-content-center">
            <div class="col-12">
                <div class="row justify-content-center ">
                    <div class="col-lg-6 text-center ">
                        <h1 class="mb-4 heading text-white" data-aos="fade-up" data-aos-delay="100">@Model.course.Name Course Content</h1>
                        <div class="mb-5 text-white desc mx-auto" data-aos="fade-up" data-aos-delay="200">
                            @if(Model.enrolled)
                            {
                                <p> You are already enrolled ! please scroll down to navigate to the course content</p>
                                <form class="d-flex justify-content-center" asp-controller="CourseContent" asp-action="UnEnroll" asp-route-id="@Model?.course.Id">
                                    <button type="submit" class="btn btn-danger btn-sm menu-absolute">UnEnroll</button>
                                </form>
                            }else {
                                <p>Please press the enroll button to view the course content</p>
                                <form class="d-flex justify-content-center" asp-controller="CourseContent" asp-action="Enroll" asp-route-id="@Model?.course.Id">
                                    <button type="submit" class="btn btn-secondary btn-sm menu-absolute">Enroll</button>
                                </form>
                            }
                            
                        </div>

                    </div>


                </div>

            </div>

        </div> <!-- /.row -->
    </div> <!-- /.container -->

</div>





<div class="container mt-4">
    <div class="row">
        <!-- Left column for video and step details -->
        <div class="col-lg-8">
            <!-- Video player (you can embed YouTube or other video players here) -->
            <div class="video-container">
                @{
                    var selectedvideo = Model.materials.ToArray()[selectedStep].VideoURL;
                }
                <iframe src="https://www.youtube.com/embed/@selectedvideo" allowfullscreen></iframe>
            </div>
            <!-- Step details -->
            <h3>Step 1: Introduction</h3>
            <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla scelerisque metus nec malesuada interdum.
            </p>
        </div>
        <!-- Right column for course steps -->
        <div class="col-lg-4">
            <h4>Course Steps</h4>
            <div class="list-group">
                @if (Model.enrolled)
                {
                    var counter = 0;
                    @foreach (var crs in Model.materials)
                    {
                        var isActive = selectedStep == counter ? "active" : "";
                        <button onclick="buttonClick(@counter)" type="button" class="list-group-item list-group-item-action step-button @isActive">Step @(++counter) : @crs.Name</button>
                    }

                }
            </div>
        </div>
    </div>
</div>

<script>
    var selectedStep = 1; // Initialize selectedStep
    function updateButtons() {
        // Loop through buttons and update their classes
        var buttons = document.querySelectorAll('.step-button');
        buttons.forEach(function (button, index) {
            var isActive = selectedStep === index ? "active" : "";
            console.log(button.classList)
            try {
                button.classList.remove("active");
            }catch(e) {
                console.log("my error " + e)
            }
            try {
                button.classList.add(isActive);
            }catch(e) {
                console.log("my error 2" + e)
            }
            //button.classList.remove("active");
            //button.classList.add(isActive);
        });
    }
    function buttonClick(index) {
        selectedStep = index;
        updateButtons();
    }
</script>